<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add Manually P-values to a ggplot — stat_pvalue_manual • ggpubr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Add Manually P-values to a ggplot — stat_pvalue_manual"><meta property="og:description" content="Add manually p-values to a ggplot, such as box blots, dot plots
 and stripcharts. Frequently asked questions are available on Datanovia ggpubr FAQ page, for example:
How to Add P-Values onto Basic GGPLOTS
How to Add Adjusted P-values to a Multi-Panel GGPlot
How to Add P-values to GGPLOT Facets
How to Add P-Values Generated Elsewhere to a GGPLOT
How to Add P-Values onto a Grouped GGPLOT using the GGPUBR R Package
How to Create Stacked Bar Plots with Error Bars and P-values
How to Add P-Values onto Horizontal GGPLOTS

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggpubr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kassambara/ggpubr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Manually P-values to a ggplot</h1>
    <small class="dont-index">Source: <a href="https://github.com/kassambara/ggpubr/blob/HEAD/R/stat_pvalue_manual.R" class="external-link"><code>R/stat_pvalue_manual.R</code></a></small>
    <div class="hidden name"><code>stat_pvalue_manual.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add manually p-values to a ggplot, such as box blots, dot plots
 and stripcharts. Frequently asked questions are available on <a href="https://www.datanovia.com/en/blog/tag/ggpubr/" class="external-link">Datanovia ggpubr FAQ page</a>, for example:</p><ul><li><p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-basic-ggplots/" class="external-link">How to Add P-Values onto Basic GGPLOTS</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/ggpubr-how-to-add-adjusted-p-values-to-a-multi-panel-ggplot/" class="external-link">How to Add Adjusted P-values to a Multi-Panel GGPlot</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-to-ggplot-facets/" class="external-link">How to Add P-values to GGPLOT Facets</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/ggpubr-how-to-add-p-values-generated-elsewhere-to-a-ggplot/" class="external-link">How to Add P-Values Generated Elsewhere to a GGPLOT</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/" class="external-link">How to Add P-Values onto a Grouped GGPLOT using the GGPUBR R Package</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/how-to-create-stacked-bar-plots-with-error-bars-and-p-values/" class="external-link">How to Create Stacked Bar Plots with Error Bars and P-values</a></p></li>
<li><p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-horizontal-ggplots/" class="external-link">How to Add P-Values onto Horizontal GGPLOTS</a></p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stat_pvalue_manual</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.position <span class="op">=</span> <span class="st">"y.position"</span>,</span>
<span>  xmin <span class="op">=</span> <span class="st">"group1"</span>,</span>
<span>  xmax <span class="op">=</span> <span class="st">"group2"</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">3.88</span>,</span>
<span>  label.size <span class="op">=</span> <span class="va">size</span>,</span>
<span>  bracket.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  bracket.nudge.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bracket.shorten <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  linetype <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tip.length <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  remove.bracket <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  step.increase <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  step.group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hide.ns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  coord.flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing statitistical test results. The expected
default format should contain the following columns: <code>group1 | group2 |
p | y.position | etc</code>. <code>group1</code> and <code>group2</code> are the groups that
have been compared. <code>p</code> is the resulting p-value. <code>y.position</code> is
the y coordinates of the p-values in the plot.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>the column containing the label (e.g.: label = "p" or label =
"p.adj"), where <code>p</code> is the p-value. Can be also an expression that can
be formatted by the <code><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a>()</code> package. For example, when
specifying label = "t-test, p = {p}", the expression {p} will be
replaced by its value.</p></dd>


<dt id="arg-y-position">y.position<a class="anchor" aria-label="anchor" href="#arg-y-position"></a></dt>
<dd><p>column containing the coordinates (in data units) to be used
for absolute positioning of the label. Default value is "y.position". Can be
also a numeric vector.</p></dd>


<dt id="arg-xmin">xmin<a class="anchor" aria-label="anchor" href="#arg-xmin"></a></dt>
<dd><p>column containing the position of the left sides of the brackets.
Default value is "group1".</p></dd>


<dt id="arg-xmax">xmax<a class="anchor" aria-label="anchor" href="#arg-xmax"></a></dt>
<dd><p>(optional) column containing the position of the right sides of
the brackets. Default value is "group2". If NULL, the p-values are plotted
as a simple text.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>x position of the p-value. Should be used only when you want plot the
p-value as text (without brackets).</p></dd>


<dt id="arg-size-label-size">size, label.size<a class="anchor" aria-label="anchor" href="#arg-size-label-size"></a></dt>
<dd><p>size of label text.</p></dd>


<dt id="arg-bracket-size">bracket.size<a class="anchor" aria-label="anchor" href="#arg-bracket-size"></a></dt>
<dd><p>Width of the lines of the bracket.</p></dd>


<dt id="arg-bracket-nudge-y">bracket.nudge.y<a class="anchor" aria-label="anchor" href="#arg-bracket-nudge-y"></a></dt>
<dd><p>Vertical adjustment to nudge brackets by. Useful to
move up or move down the bracket. If positive value, brackets will be moved
up; if negative value, brackets are moved down.</p></dd>


<dt id="arg-bracket-shorten">bracket.shorten<a class="anchor" aria-label="anchor" href="#arg-bracket-shorten"></a></dt>
<dd><p>a small numeric value in [0-1] for shortening the with
of bracket.</p></dd>


<dt id="arg-color">color<a class="anchor" aria-label="anchor" href="#arg-color"></a></dt>
<dd><p>text and line color. Can be variable name in the data for coloring by groups.</p></dd>


<dt id="arg-linetype">linetype<a class="anchor" aria-label="anchor" href="#arg-linetype"></a></dt>
<dd><p>linetype. Can be variable name in the data for changing linetype by groups.</p></dd>


<dt id="arg-tip-length">tip.length<a class="anchor" aria-label="anchor" href="#arg-tip-length"></a></dt>
<dd><p>numeric vector with the fraction of total height that the
bar goes down to indicate the precise column. Default is 0.03.</p></dd>


<dt id="arg-remove-bracket">remove.bracket<a class="anchor" aria-label="anchor" href="#arg-remove-bracket"></a></dt>
<dd><p>logical, if <code>TRUE</code>, brackets are removed from the
plot. Considered only in the situation, where comparisons are performed
against reference group or against "all".</p></dd>


<dt id="arg-step-increase">step.increase<a class="anchor" aria-label="anchor" href="#arg-step-increase"></a></dt>
<dd><p>numeric vector with the increase in fraction of total
height for every additional comparison to minimize overlap.</p></dd>


<dt id="arg-step-group-by">step.group.by<a class="anchor" aria-label="anchor" href="#arg-step-group-by"></a></dt>
<dd><p>a variable name for grouping brackets before adding
step.increase. Useful to group bracket by facet panel.</p></dd>


<dt id="arg-hide-ns">hide.ns<a class="anchor" aria-label="anchor" href="#arg-hide-ns"></a></dt>
<dd><p>can be logical value or a character vector.</p><ul><li><p>Case when logical value. If TRUE, hide ns symbol when displaying
 significance levels. Filter is done by checking the column
 <code>p.adj.signif</code>, <code>p.signif</code>, <code>p.adj</code> and <code>p</code>.</p></li>
<li><p>Case when character value. Possible values are "p" or "p.adj", for filtering out non significant.</p></li>
</ul></dd>


<dt id="arg-vjust">vjust<a class="anchor" aria-label="anchor" href="#arg-vjust"></a></dt>
<dd><p>move the text up or down relative to the bracket. Can be also a
column name available in the data.</p></dd>


<dt id="arg-coord-flip">coord.flip<a class="anchor" aria-label="anchor" href="#arg-coord-flip"></a></dt>
<dd><p>logical. If <code>TRUE</code>, flip x and y coordinates so that
horizontal becomes vertical, and vertical, horizontal. When adding the
p-values to a horizontal ggplot (generated using
<code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a>()</code>), you need to specify the option
<code>coord.flip = TRUE</code>.</p></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>position adjustment, either as a string, or the result of a
call to a position adjustment function.</p></dd>


<dt id="arg-inherit-aes">inherit.aes<a class="anchor" aria-label="anchor" href="#arg-inherit-aes"></a></dt>
<dd><p>If <code>FALSE</code> (the default), overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code>stat_pvalue_manual()</code>. Most layers should use
<code>TRUE</code> (the <span class="pkg">ggplot2</span> default), but <code>stat_pvalue_manual()</code> uses
its own data with different column names than the parent plot data, so
<code>FALSE</code> avoids conflicts between parent plot aesthetics (like <code>fill</code> or
<code>color</code>) and the p-value annotation data.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments passed to the function <code><a href="geom_bracket.html">geom_bracket()</a></code> or
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code></p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="stat_compare_means.html">stat_compare_means</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># T-test</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="compare_means.html">compare_means</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">len</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">ToothGrowth</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"t.test"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .y.   group1 group2        p   p.adj p.format p.signif method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> len   0.5    1      1.27<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 2.5<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 1.3e-07  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> len   0.5    2      4.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span> 1.3<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span> 4.4e-14  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> len   1      2      1.91<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span> 1.9<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span> 1.9e-05  ****     T-test</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a simple box plot</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="ggboxplot.html">ggboxplot</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, x <span class="op">=</span> <span class="st">"dose"</span>, y <span class="op">=</span> <span class="st">"len"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span></span></span>
<span class="r-plt img"><img src="stat_pvalue_manual-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform a t-test between groups</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="compare_means.html">compare_means</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">len</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">ToothGrowth</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"t.test"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .y.   group1 group2        p   p.adj p.format p.signif method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> len   0.5    1      1.27<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 2.5<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 1.3e-07  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> len   0.5    2      4.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span> 1.3<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span> 4.4e-14  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> len   1      2      1.91<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span> 1.9<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span> 1.9e-05  ****     T-test</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add manually p-values from stat.test data</span></span></span>
<span class="r-in"><span><span class="co"># First specify the y.position of each comparison</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="va">stat.test</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>y.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29</span>, <span class="fl">35</span>, <span class="fl">39</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">stat_pvalue_manual</span><span class="op">(</span><span class="va">stat.test</span>, label <span class="op">=</span> <span class="st">"p.adj"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stat_pvalue_manual-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize the label with glue expression</span></span></span>
<span class="r-in"><span><span class="co"># (https://github.com/tidyverse/glue)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">stat_pvalue_manual</span><span class="op">(</span><span class="va">stat.test</span>, label <span class="op">=</span> <span class="st">"p = {p.adj}"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stat_pvalue_manual-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped bar plots</span></span></span>
<span class="r-in"><span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="r-in"><span><span class="va">ToothGrowth</span><span class="op">$</span><span class="va">dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Comparisons against reference</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="compare_means.html">compare_means</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">len</span> <span class="op">~</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">ToothGrowth</span>, group.by <span class="op">=</span> <span class="st">"supp"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"t.test"</span>, ref.group <span class="op">=</span> <span class="st">"0.5"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stat.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   supp  .y.   group1 group2            p      p.adj p.format p.signif method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> VC    len   0.5    1      0.000<span style="text-decoration: underline;">000</span>681  0.000<span style="text-decoration: underline;">002</span>   6.8e-07  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> VC    len   0.5    2      0.000<span style="text-decoration: underline;">000</span>046<span style="text-decoration: underline;">8</span> 0.000<span style="text-decoration: underline;">000</span>19 4.7e-08  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> OJ    len   0.5    1      0.000<span style="text-decoration: underline;">087</span>8    0.000<span style="text-decoration: underline;">088</span>   8.8e-05  ****     T-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> OJ    len   0.5    2      0.000<span style="text-decoration: underline;">001</span>32   0.000<span style="text-decoration: underline;">002</span>6  1.3e-06  ****     T-test</span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="ggbarplot.html">ggbarplot</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, x <span class="op">=</span> <span class="st">"supp"</span>, y <span class="op">=</span> <span class="st">"len"</span>,</span></span>
<span class="r-in"><span>                fill <span class="op">=</span> <span class="st">"dose"</span>, palette <span class="op">=</span> <span class="st">"jco"</span>,</span></span>
<span class="r-in"><span>                add <span class="op">=</span> <span class="st">"mean_sd"</span>, add.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"dose"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">+</span> <span class="fu">stat_pvalue_manual</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">stat.test</span>, x <span class="op">=</span> <span class="st">"supp"</span>, y.position <span class="op">=</span> <span class="fl">33</span>,</span></span>
<span class="r-in"><span>  label <span class="op">=</span> <span class="st">"p.signif"</span>,</span></span>
<span class="r-in"><span>  position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stat_pvalue_manual-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

